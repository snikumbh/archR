<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example usage of _archR_ on simulated DNA sequences • archR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example usage of _archR_ on simulated DNA sequences">
<meta property="og:description" content="archR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">archR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/archR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/snikumbh/archR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="archR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example usage of <em>archR</em> on simulated DNA sequences</h1>
                        <h4 class="author">Sarvesh Nikumbh</h4>
            
            <h4 class="date">2020-12-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/snikumbh/archR/blob/master/vignettes/archR.Rmd"><code>vignettes/archR.Rmd</code></a></small>
      <div class="hidden name"><code>archR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><em>archR</em> is a non-negative matrix factorization (NMF)-based unsupervised learning approach for identifying different core promoter sequence architectures. <em>archR</em> implements an algorithm based on chunking and iterative processing. While matrix factorization-based applications are known to scale poorly for large amounts of data, archR’s algorithm enables scalable processing of large number of sequences. A notable advantage of archR is that the sequence motifs – the lengths and positional specificities of individual motifs, and complex inter-relationships where multiple motifs are at play in tandem, all are simultaneously inferred from the data. To our knowledge, this is a novel application of NMF on biological sequence data capable of simultaneously discovering the sequence motifs and their positions. For a more detailed discussion, see preprint/publication [TODO: link here].</p>
<p>This vignette demonstrates <em>archR</em>’s usage with the help of a synthetic DNA sequences data set. Please refer to the paper (TODO: cite paper/preprint) for a detailed description of <em>archR</em>’s algorithm. The paper also discusses the various parameters and their settings. For completeness, the following section gives a brief overview of the algorithm.</p>
</div>
<div id="archrs-algorithm" class="section level1">
<h1 class="hasAnchor">
<a href="#archrs-algorithm" class="anchor"></a><em>archR</em>’s algorithm</h1>
<p><em>archR</em> implements a chunking-based iterative procedure. Below is a schematic of archR’s algorithm.</p>
<p><img src="archR_algorithm_static_illustrator_cropped.png" width="550" align="center"></p>
<!-- ![Schematic of archR's algorithm]() -->
<!-- ![Schematic of archR's algorithm](archR_algorithm_1080p_cropped.gif) -->
<p>Further details to follow.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p><em>archR</em> is currently made available via GitHub, thus, you can use the following procedure for installing <em>archR</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"snikumbh/archR"</span><span class="op">)</span>
 </code></pre></div>
<p>In case of any errors, please consider looking up <a href="https://github.com/snikumbh/archR">https://github.com/snikumbh/archR</a>. If none of the already noted points with regards to troubleshooting <em>archR</em>’s installation help, please file a <a href="https://github.com/snikumbh/archR/issues/new">new issue</a>.</p>
</div>
<div id="working-with-archr" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-archr" class="anchor"></a>Working with <em>archR</em>
</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load archR</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://snikumbh.github.io/archR/">archR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings">Biostrings</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'BiocGenerics'</span>
<span class="co">#&gt; The following objects are masked from 'package:parallel':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
<span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
<span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     IQR, mad, sd, var, xtabs</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
<span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
<span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
<span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
<span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
<span class="co">#&gt;     union, unique, unsplit, which.max, which.min</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'S4Vectors'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand.grid</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Biostrings'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     strsplit</span>


<span class="co"># Set seed for reproducibility</span>
<span class="va">seed_val</span> <span class="op">&lt;-</span> <span class="fl">11992288</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed_val</span><span class="op">)</span></code></pre></div>
<div id="synthetic-data-explained" class="section level2">
<h2 class="hasAnchor">
<a href="#synthetic-data-explained" class="anchor"></a>Synthetic data explained</h2>
<p>In order to demonstrate the efficacy of <em>archR</em>, we use <em>archR</em> to cluster DNA sequences in a synthetic data set which was generated as follows. A set of 200 simulated DNA sequences was generated, each 100 nucleotides long and with uniform probability for all nucleotides. These sequences have four clusters in them, each with 50 sequences. The profiles of the four clusters are:</p>
<table class="table">
<thead><tr class="header">
<th>Cluster</th>
<th align="left">Characteristic Motifs</th>
<th align="left">Motif Occurrence Position</th>
<th>#Sequences</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td align="left">Dinucleotide repeat <code>AT</code>
</td>
<td align="left">every 10 nt</td>
<td>50</td>
</tr>
<tr class="even">
<td>B</td>
<td align="left"><code>GATTACA</code></td>
<td align="left">40</td>
<td>50</td>
</tr>
<tr class="odd">
<td></td>
<td align="left"><code>GAGAG</code></td>
<td align="left">60</td>
<td></td>
</tr>
<tr class="even">
<td>C</td>
<td align="left"><code>GAGAG</code></td>
<td align="left">60</td>
<td>50</td>
</tr>
<tr class="odd">
<td>D</td>
<td align="left"><code>GAGAG</code></td>
<td align="left">80</td>
<td>50</td>
</tr>
<tr class="even">
<td></td>
<td align="left"><code>TCAT</code></td>
<td align="left">40</td>
<td></td>
</tr>
</tbody>
</table>
<!-- ----------|----------|----------|----------| --><p>All the motifs across the clusters were planted with a mutation rate of 0.</p>
</div>
<div id="input-and-feature-representation" class="section level2">
<h2 class="hasAnchor">
<a href="#input-and-feature-representation" class="anchor"></a>Input and feature representation</h2>
<p>We use one-hot encoding to represent the dinucleotide profiles of each sequence in the data set. <em>archR</em> provides functions to read input from (a) a FASTA file, and (b) <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html">Biostrings::DNAStringSet</a></code> object.</p>
<div id="reading-input-as-fasta-file" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-input-as-fasta-file" class="anchor"></a>Reading input as FASTA file</h3>
<p>The function <code><a href="../reference/prepare_data_from_FASTA.html">archR::prepare_data_from_FASTA()</a></code> enables one-hot-encoding the DNA sequences in the given FASTA file. The one-hot-encoded sequences are returned as a sparse matrix with as many columns as the number of sequences in the FASTA file and (#sequences x <span class="math inline">\(4^{2}\)</span>) rows when dinucleotide profiles is selected. The number of rows will be (#sequences x <span class="math inline">\(4\)</span>) when mononucleotide profiles is selected. See the <code>sinuc_or_dinuc</code> argument.</p>
<p>Upon setting the logical argument <code>rawSeq</code> to <code>TRUE</code>, the function returns the raw sequences as a <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html">Biostrings::DNAStringSet</a></code> object, with <code>FALSE</code> it returns the column-wise one-hot encoded representation as noted above. When <code>rawSeq</code> is <code>TRUE</code>, <code>sinuc_or_dinuc</code> argument is ignored.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creation of one-hot encoded data matrix from FASTA file</span>
<span class="va">inputFastaFilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_data.fa"</span>, 
                                  package <span class="op">=</span> <span class="st">"archR"</span>, 
                                  mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Specifying `dinuc` generates dinucleotide features</span>
<span class="va">inputSeqsMat</span> <span class="op">&lt;-</span> <span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_data_from_FASTA.html">prepare_data_from_FASTA</a></span><span class="op">(</span><span class="va">inputFastaFilename</span>,
                                                  sinuc_or_dinuc <span class="op">=</span> <span class="st">"dinuc"</span><span class="op">)</span>
<span class="co">#&gt; Sequences OK,</span>
<span class="co">#&gt; Read 200 sequences</span>
<span class="co">#&gt; Generating dinucleotide profiles</span>

<span class="va">inputSeqsRaw</span> <span class="op">&lt;-</span> <span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_data_from_FASTA.html">prepare_data_from_FASTA</a></span><span class="op">(</span><span class="va">inputFastaFilename</span>, 
                                               rawSeq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">nSeqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">inputSeqsRaw</span><span class="op">)</span>
<span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu">width</span><span class="op">(</span><span class="va">inputSeqsRaw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">sinuc</span> <span class="op">&lt;-</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Biostrings/man/DNAString-class.html">DNA_BASES</a></span></code></pre></div>
</div>
<div id="reading-input-as-a-dnastringset-object" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-input-as-a-dnastringset-object" class="anchor"></a>Reading input as a DNAStringSet object</h3>
<p>If you already have a <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html">Biostrings::DNAStringSet</a></code> object, you can use the <code><a href="../reference/get_one_hot_encoded_seqs.html">get_one_hot_encoded_seqs()</a></code> function which directly accepts a <code>DNAStringSet</code> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creation of one-hot encoded data matrix from a DNAStringSet object</span>
<span class="va">inputSeqs_direct</span> <span class="op">&lt;-</span> <span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/get_one_hot_encoded_seqs.html">get_one_hot_encoded_seqs</a></span><span class="op">(</span><span class="va">inputSeqsRaw</span>, 
                                                  sinuc_or_dinuc <span class="op">=</span> <span class="st">"dinuc"</span><span class="op">)</span>
<span class="co">#&gt; Generating dinucleotide profiles</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">inputSeqs_direct</span>, <span class="va">inputSeqsMat</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
</div>
<div id="visualize-input-sequences-as-an-image" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-input-sequences-as-an-image" class="anchor"></a>Visualize input sequences as an image</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualize the sequences in a image matrix where the DNA bases are assigned fixed</span>
<span class="co"># colors</span>

<span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/viz_seqs_as_acgt_mat_from_seqs.html">viz_seqs_as_acgt_mat_from_seqs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">inputSeqsRaw</span><span class="op">)</span>, 
                          position_labels <span class="op">=</span> <span class="va">positions</span>, 
                          savefilename <span class="op">=</span> <span class="cn">NULL</span>
                          <span class="op">)</span></code></pre></div>
<p><img src="archR_files/figure-html/plot-seqs-1.png" width="480"></p>
</div>
<div id="calling-archr" class="section level2">
<h2 class="hasAnchor">
<a href="#calling-archr" class="anchor"></a>Calling <em>archR</em>
</h2>
<p>Setup archR configuration as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set archR configuration</span>
<span class="va">archRconfig</span> <span class="op">&lt;-</span> <span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/archRSetConfig.html">archRSetConfig</a></span><span class="op">(</span>
        parallelize <span class="op">=</span> <span class="cn">TRUE</span>,
        nCoresUse <span class="op">=</span> <span class="fl">2</span>,
        nIterationsUse <span class="op">=</span> <span class="fl">100</span>,
        kMin <span class="op">=</span> <span class="fl">1</span>,
        kMax <span class="op">=</span> <span class="fl">20</span>,
        modSelType <span class="op">=</span> <span class="st">"stability"</span>,
        tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>,
        bound <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span>,
        innerChunkSize <span class="op">=</span> <span class="fl">100</span>,
        flags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>debugFlag <span class="op">=</span> <span class="cn">FALSE</span>, timeFlag <span class="op">=</span> <span class="cn">TRUE</span>, verboseFlag <span class="op">=</span> <span class="cn">TRUE</span>,
                     plotVerboseFlag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Once the configuration is setup, call the <code><a href="../reference/archR.html">archR::archR</a></code> function with user-specified iterations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Call/Run archR</span>
<span class="va">perform_iters</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">archRresult</span> <span class="op">&lt;-</span> <span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/archR.html">archR</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">archRconfig</span>,
                               seqsMat <span class="op">=</span> <span class="va">inputSeqsMat</span>,
                               seqsRaw <span class="op">=</span> <span class="va">inputSeqsRaw</span>,
                               seqsPositions <span class="op">=</span> <span class="va">positions</span>,
                               thresholdItr <span class="op">=</span> <span class="va">perform_iters</span><span class="op">)</span>
<span class="co">#&gt; Parallelization with 2 cores</span>
<span class="co">#&gt; Model selection by factor stability</span>
<span class="co">#&gt; Tolerance: 1e-04 &amp; Bound: 1e-08</span>
<span class="co">#&gt; === archR to perform 2 iteration(s) ===</span>
<span class="co">#&gt; === Iteration 1, 1 chunk(s) ===</span>
<span class="co">#&gt; [Outer chunk 1/1] [Size: 200]</span>
<span class="co">#&gt; Decision: Processing</span>
<span class="co">#&gt; [Inner chunk 1/2] [Size: 100]</span>
<span class="co">#&gt; Checking K = 1</span>
<span class="co">#&gt; Checking K = 2</span>
<span class="co">#&gt; Checking K = 3</span>
<span class="co">#&gt; Checking K = 4</span>
<span class="co">#&gt; Best K for this subset: 3</span>
<span class="co">#&gt; Fetching 3 clusters</span>
<span class="co">#&gt; [Inner chunk 2/2] [Size: 100]</span>
<span class="co">#&gt; Checking K = 1</span>
<span class="co">#&gt; Checking K = 2</span>
<span class="co">#&gt; Checking K = 3</span>
<span class="co">#&gt; Checking K = 4</span>
<span class="co">#&gt; Best K for this subset: 3</span>
<span class="co">#&gt; Fetching 3 clusters</span>
<span class="co">#&gt; [Outer chunk 1/1] complete</span>
<span class="co">#&gt; [Iteration 1] complete</span>
<span class="co">#&gt; Managing clusters from outer chunk(s)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Updating sequence cluster labels</span>
<span class="co">#&gt; #Clusters: 3</span>
<span class="co">#&gt; Iteration 1 completed in 1.19 mins</span>
<span class="co">#&gt; 1.2 mins ellapsed since start</span>
<span class="co">#&gt; === Iteration 2, 3 chunk(s) ===</span>
<span class="co">#&gt; [Outer chunk 1/3] [Size: 100]</span>
<span class="co">#&gt; Decision: Processing</span>
<span class="co">#&gt; [Inner chunk 1/1] [Size: 100]</span>
<span class="co">#&gt; Checking K = 1</span>
<span class="co">#&gt; Checking K = 2</span>
<span class="co">#&gt; Checking K = 3</span>
<span class="co">#&gt; Best K for this subset: 2</span>
<span class="co">#&gt; Fetching 2 clusters</span>
<span class="co">#&gt; [Outer chunk 1/3] complete</span>
<span class="co">#&gt; [Outer chunk 2/3] [Size: 50]</span>
<span class="co">#&gt; Decision: Processing</span>
<span class="co">#&gt; [Inner chunk 1/1] [Size: 50]</span>
<span class="co">#&gt; Checking K = 1</span>
<span class="co">#&gt; Checking K = 2</span>
<span class="co">#&gt; Best K for this subset: 1</span>
<span class="co">#&gt; Fetching 1 clusters</span>
<span class="co">#&gt; [Outer chunk 2/3] complete</span>
<span class="co">#&gt; [Outer chunk 3/3] [Size: 50]</span>
<span class="co">#&gt; Decision: Processing</span>
<span class="co">#&gt; [Inner chunk 1/1] [Size: 50]</span>
<span class="co">#&gt; Checking K = 1</span>
<span class="co">#&gt; Checking K = 2</span>
<span class="co">#&gt; Best K for this subset: 1</span>
<span class="co">#&gt; Fetching 1 clusters</span>
<span class="co">#&gt; [Outer chunk 3/3] complete</span>
<span class="co">#&gt; [Iteration 2] complete</span>
<span class="co">#&gt; Managing clusters from outer chunk(s)</span>
<span class="co">#&gt; Updating sequence cluster labels</span>
<span class="co">#&gt; #Clusters: 4</span>
<span class="co">#&gt; Iteration 2 completed in 0.969 mins</span>
<span class="co">#&gt; 2.16 mins ellapsed since start</span>
<span class="co">#&gt; No element pairs close enough by given distance threshold: 3</span>
<span class="co">#&gt; Updating sequence cluster labels</span>
<span class="co">#&gt; #Clusters: 4</span>
<span class="co">#&gt; archR exiting, 2.16 mins</span></code></pre></div>
</div>
<div id="understanding-the-result-object-from-archr" class="section level2">
<h2 class="hasAnchor">
<a href="#understanding-the-result-object-from-archr" class="anchor"></a>Understanding the result object from <em>archR</em>
</h2>
<p>In the version 0.1.3, <em>archR</em> naively returns a result object which is a nested list. The list elements include: 1. the sequence cluster labels per iteration [<code>seqsClustLabels</code>]; 2. the collection of NMF basis vectors per iteration [<code>clustBasisVectors</code>]: each is a list of two elements <code>nBasisVectors</code> and <code>basisVectors</code>; 3. the clustering solution, [<code>clustSol</code>], which is obtained upon combining raw clusters from the last iteration of archR. This element stores the clustering of NMF basis vectors [<code>basisVectorsClust</code>] and the sequence clusters [<code>clusters</code>]; 4. the raw sequences provided [<code>rawSeqs</code>]; 5. the configuration setting [<code>config</code>]; and 6. the call itself [<code>call</code>].</p>
<div id="nmf-basis-vectors" class="section level3">
<h3 class="hasAnchor">
<a href="#nmf-basis-vectors" class="anchor"></a>NMF basis vectors</h3>
<p><em>archR</em> stores the NMF basis vectors corresponding to each cluster in every iteration in the variable <code>clustBasisVectors</code>. <code>clustBasisVectors</code> is a numbered list corresponding to the number of iterations performed. This is then again a list holding two pieces of information: the number of basis vectors (<code>nBasisVectors</code>) and the basis vectors (<code>basisVectors</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Basis vectors at iteration 2</span>
<span class="va">archRresult</span><span class="op">$</span><span class="va">clustBasisVectors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nBasisVectors</span>
<span class="co">#&gt; [1] 4</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">archRresult</span><span class="op">$</span><span class="va">clustBasisVectors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">basisVectors</span><span class="op">)</span>
<span class="co">#&gt; [1] 1600    4</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">archRresult</span><span class="op">$</span><span class="va">clustBasisVectors</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">basisVectors</span><span class="op">)</span>
<span class="co">#&gt;             [,1]       [,2]       [,3]       [,4]</span>
<span class="co">#&gt; [1,] 0.120738792 0.07407943 0.05168607 0.08186580</span>
<span class="co">#&gt; [2,] 0.087064002 0.08679650 0.02486037 0.07917296</span>
<span class="co">#&gt; [3,] 0.080387155 0.03793825 0.05076204 0.05196331</span>
<span class="co">#&gt; [4,] 0.074604999 0.04276979 0.09945618 0.05334238</span>
<span class="co">#&gt; [5,] 0.080342833 0.11748608 0.07484865 0.10758754</span>
<span class="co">#&gt; [6,] 0.007200647 0.11873504 0.05051104 0.10543655</span></code></pre></div>
</div>
</div>
<div id="visualize-results-from-archr" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-results-from-archr" class="anchor"></a>Visualize results from <em>archR</em>
</h2>
<p>In this section we demonstrate how to visualize results from <em>archR</em>. One can visualize the NMF basis vectors as well as the sequence clusters.</p>
<!-- ### Visualizing NMF basis vectors at any iteration -->
<!-- We can visualize the basis vectors corresponding to each cluster at any  -->
<!-- iteration.  -->
<!-- These per-iteration basis vectors are available from the `archRresult` object  -->
<!-- (see above Section). -->
<!-- ```{r viz-BV-1, echo=TRUE, fig.height=2, fig.width=25} -->
<!-- archR::viz_basis_vectors_as_seqlogo( -->
<!--     archRresult$clustBasisVectors[[1]]$basisVectors, -->
<!--     position_labels = positions, -->
<!--     plotMethod = "bits" -->
<!-- ) -->
<!-- archR::viz_basis_vectors_as_heatmap( -->
<!--     archRresult$clustBasisVectors[[1]]$basisVectors, -->
<!--     position_labels = positions) -->
<!-- ``` -->
<!-- ```{r viz-BV-2, fig.height=2, fig.width=25, echo=TRUE} -->
<!-- archR::viz_basis_vectors_as_seqlogo( -->
<!--     archRresult$clustBasisVectors[[2]]$basisVectors, -->
<!--     position_labels = positions, -->
<!--     plotMethod = "bits" -->
<!-- ) -->
<!-- archR::viz_basis_vectors_as_heatmap( -->
<!--   archRresult$clustBasisVectors[[2]]$basisVectors, -->
<!--   position_labels = positions) -->
<!-- ``` -->
<!-- ```{r visualize-basis-vectors-combined, echo=TRUE, fig.height=4, fig.width=25} -->
<!-- archR::viz_basis_vectors_in_combined_heatmaps_seqlogos( -->
<!--   archRresult$clustBasisVectors[[2]]$basisVectors, -->
<!--   position_labels = positions, plotMethod = "bits", savePDFfilename = NULL -->
<!-- ) -->
<!-- ``` -->
<!-- The `plotMethod` argument to functions producing sequence logos is supplied to  -->
<!-- the call to `ggseqlogo`. The possible values are `custom`, `bits`. -->
<p>The clustered output from <em>archR</em> can again be visualized as a matrix. Simply sort the sequences based on the cluster labels assigned to them and call <code><a href="../reference/viz_seqs_as_acgt_mat_from_seqs.html">archR::viz_seqs_as_acgt_mat_from_seqs</a></code> with the sorted order as shown.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">itr</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">seqsClustLabels</span> <span class="op">&lt;-</span> <span class="va">archRresult</span><span class="op">$</span><span class="va">seqsClustLabels</span><span class="op">[[</span><span class="va">itr</span><span class="op">]</span><span class="op">]</span>
<span class="va">sorted_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">seqsClustLabels</span>, index.return <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/viz_seqs_as_acgt_mat_from_seqs.html">viz_seqs_as_acgt_mat_from_seqs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">inputSeqsRaw</span><span class="op">[</span><span class="va">sorted_order</span><span class="op">$</span><span class="va">ix</span><span class="op">]</span><span class="op">)</span>,
                         position_labels <span class="op">=</span> <span class="va">positions</span>,
                         savefilename <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="archR_files/figure-html/visualize-clusters-itr1-1.png" alt="Figure: Clusters at iteration 1" width="480"><p class="caption">
Figure: Clusters at iteration 1
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">itr</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">seqsClustLabels</span> <span class="op">&lt;-</span> <span class="va">archRresult</span><span class="op">$</span><span class="va">seqsClustLabels</span><span class="op">[[</span><span class="va">itr</span><span class="op">]</span><span class="op">]</span>
<span class="va">sorted_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">seqsClustLabels</span>, index.return <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="fu">archR</span><span class="fu">::</span><span class="fu"><a href="../reference/viz_seqs_as_acgt_mat_from_seqs.html">viz_seqs_as_acgt_mat_from_seqs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">inputSeqsRaw</span><span class="op">[</span><span class="va">sorted_order</span><span class="op">$</span><span class="va">ix</span><span class="op">]</span><span class="op">)</span>,
                         position_labels <span class="op">=</span> <span class="va">positions</span>,
                         savefilename <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="archR_files/figure-html/visualize-clusters-itr2-1.png" alt="Figure: Clusters at iteration 2" width="480"><p class="caption">
Figure: Clusters at iteration 2
</p>
</div>
<!-- ![_archR_ result on example data w/ clusters](./archR-result-example-data.png) -->
<!-- This output in Figure 1 was generated by performing 100 bootstrapped iterations,  -->
<!-- parallely by setting the following configuration parameters to _archR_: -->
<!-- `nIterations = 100, nCoresUse = 4, parallelize = TRUE`. -->
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p><em>archR</em> can detect <em>de novo</em> sequence features and simultaneously identify the complex interactions of different features together with their positional specificities.</p>
<p>Note that the sequence architectures identified by <em>archR</em> have no limitations due to the size of the motifs or gaps in them, distance between motifs, compositional and positional variations in the individual motifs and their effects on the complex interactions, and number of motifs involved in any interaction. <!-- It is advisable to perform a large number of bootstrapped iterations for NMF in  --> <!-- _archR_.  --> <!-- This potentially affects the computation time of _archR_.  --> <!-- But being an  --> <!-- embarrasingly parallelizable case, this issue is alleviated.  --> <!-- There are already  --> <!-- provisions in _archR_ to choose parallelization for speeding up computations. --></p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h1>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.0.3 (2020-10-10)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats4    parallel  stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] Biobase_2.50.0      Biostrings_2.58.0   XVector_0.30.0     </span>
<span class="co">#&gt; [4] IRanges_2.24.1      S4Vectors_0.28.1    BiocGenerics_0.36.0</span>
<span class="co">#&gt; [7] archR_0.1.3        </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] colorspace_2.0-0            ellipsis_0.3.1             </span>
<span class="co">#&gt;   [3] class_7.3-17                modeltools_0.2-23          </span>
<span class="co">#&gt;   [5] mclust_5.4.7                rprojroot_2.0.2            </span>
<span class="co">#&gt;   [7] GenomicRanges_1.42.0        fs_1.5.0                   </span>
<span class="co">#&gt;   [9] flexmix_2.3-17              bit64_4.0.5                </span>
<span class="co">#&gt;  [11] AnnotationDbi_1.52.0        R.methodsS3_1.8.1          </span>
<span class="co">#&gt;  [13] codetools_0.2-16            doParallel_1.0.16          </span>
<span class="co">#&gt;  [15] robustbase_0.93-6           knitr_1.30                 </span>
<span class="co">#&gt;  [17] hopach_2.50.0               jsonlite_1.7.2             </span>
<span class="co">#&gt;  [19] Rsamtools_2.6.0             seqLogo_1.56.0             </span>
<span class="co">#&gt;  [21] gridBase_0.4-7              annotate_1.68.0            </span>
<span class="co">#&gt;  [23] GO.db_3.12.1                cluster_2.1.0              </span>
<span class="co">#&gt;  [25] kernlab_0.9-29              png_0.1-7                  </span>
<span class="co">#&gt;  [27] R.oo_1.24.0                 readr_1.4.0                </span>
<span class="co">#&gt;  [29] compiler_4.0.3              httr_1.4.2                 </span>
<span class="co">#&gt;  [31] assertthat_0.2.1            Matrix_1.2-18              </span>
<span class="co">#&gt;  [33] htmltools_0.5.0             tools_4.0.3                </span>
<span class="co">#&gt;  [35] gtable_0.3.0                glue_1.4.2                 </span>
<span class="co">#&gt;  [37] TFMPvalue_0.0.8             GenomeInfoDbData_1.2.4     </span>
<span class="co">#&gt;  [39] reshape2_1.4.4              dplyr_1.0.2                </span>
<span class="co">#&gt;  [41] Rcpp_1.0.5                  pkgdown_1.6.1              </span>
<span class="co">#&gt;  [43] NMF_0.23.0                  vctrs_0.3.6                </span>
<span class="co">#&gt;  [45] rtracklayer_1.50.0          iterators_1.0.13           </span>
<span class="co">#&gt;  [47] fpc_2.2-9                   ggseqlogo_0.1              </span>
<span class="co">#&gt;  [49] xfun_0.19                   CNEr_1.26.0                </span>
<span class="co">#&gt;  [51] stringr_1.4.0               lifecycle_0.2.0            </span>
<span class="co">#&gt;  [53] poweRlaw_0.70.6             rngtools_1.5               </span>
<span class="co">#&gt;  [55] gtools_3.8.2                XML_3.99-0.5               </span>
<span class="co">#&gt;  [57] DEoptimR_1.0-8              zlibbioc_1.36.0            </span>
<span class="co">#&gt;  [59] MASS_7.3-53                 scales_1.1.1               </span>
<span class="co">#&gt;  [61] BSgenome_1.58.0             ragg_0.4.0                 </span>
<span class="co">#&gt;  [63] hms_0.5.3                   MatrixGenerics_1.2.0       </span>
<span class="co">#&gt;  [65] SummarizedExperiment_1.20.0 RColorBrewer_1.1-2         </span>
<span class="co">#&gt;  [67] yaml_2.2.1                  memoise_1.1.0              </span>
<span class="co">#&gt;  [69] reticulate_1.18-9000        ggplot2_3.3.2              </span>
<span class="co">#&gt;  [71] pkgmaker_0.32.2             stringi_1.5.3              </span>
<span class="co">#&gt;  [73] RSQLite_2.2.1               highr_0.8                  </span>
<span class="co">#&gt;  [75] desc_1.2.0                  foreach_1.5.1              </span>
<span class="co">#&gt;  [77] caTools_1.18.0              BiocParallel_1.24.1        </span>
<span class="co">#&gt;  [79] GenomeInfoDb_1.26.2         rlang_0.4.9                </span>
<span class="co">#&gt;  [81] pkgconfig_2.0.3             systemfonts_0.3.2          </span>
<span class="co">#&gt;  [83] prabclus_2.3-2              bitops_1.0-6               </span>
<span class="co">#&gt;  [85] matrixStats_0.57.0          pracma_2.2.9               </span>
<span class="co">#&gt;  [87] evaluate_0.14               lattice_0.20-41            </span>
<span class="co">#&gt;  [89] purrr_0.3.4                 GenomicAlignments_1.26.0   </span>
<span class="co">#&gt;  [91] bit_4.0.4                   tidyselect_1.1.0           </span>
<span class="co">#&gt;  [93] plyr_1.8.6                  magrittr_2.0.1             </span>
<span class="co">#&gt;  [95] R6_2.5.0                    generics_0.1.0             </span>
<span class="co">#&gt;  [97] DelayedArray_0.16.0         DBI_1.1.0                  </span>
<span class="co">#&gt;  [99] pillar_1.4.7                withr_2.3.0                </span>
<span class="co">#&gt; [101] KEGGREST_1.30.1             RCurl_1.98-1.2             </span>
<span class="co">#&gt; [103] nnet_7.3-14                 tibble_3.0.4               </span>
<span class="co">#&gt; [105] crayon_1.3.4                rmarkdown_2.6              </span>
<span class="co">#&gt; [107] TFBSTools_1.28.0            grid_4.0.3                 </span>
<span class="co">#&gt; [109] blob_1.2.1                  digest_0.6.27              </span>
<span class="co">#&gt; [111] diptest_0.75-7              xtable_1.8-4               </span>
<span class="co">#&gt; [113] R.utils_2.10.1              textshaping_0.2.1          </span>
<span class="co">#&gt; [115] munsell_0.5.0               DirichletMultinomial_1.32.0</span>
<span class="co">#&gt; [117] registry_0.5-1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sarvesh Nikumbh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
